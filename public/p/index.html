<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../assets/styles/browser.css" />
    <script src="../scram/scramjet.all.js"></script>
    <script defer src="../assets/js/browser.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.2/dist/gsap.min.js"></script>
    <script
      src="https://kit.fontawesome.com/adc83d139e.js"
      crossorigin="anonymous"
    ></script>
    <title>Galaxy Browser</title>
  </head>
  <body id="body">
    <div id="nav">
      <div id="tabGroup"></div>
      <div id="plusdiv" onclick="newTab()">
        <p class="plus">+</p>
      </div>
    </div>

    <div class="toolbar">
      <div class="goBack toolbarBtn" id="goBack">
        <i class="fa-solid fa-arrow-left"></i>
      </div>
      <div class="goForward toolbarBtn" id="goForward">
        <i class="fa-solid fa-arrow-right"></i>
      </div>
      <div class="reload toolbarBtn" id="reload">
        <i class="fa-solid fa-rotate-right"></i>
      </div>
      <input id="rogoisdabest" placeholder="search" class="search" />
      <div class="more toolbarBtn" id="more">
        <i class="fa-solid fa-ellipsis-vertical"></i>
      </div>
    </div>

    <script type="module">
      import {
        setTransport,
        setWisp,
        makeURL,
        getProxied,
      } from "../lithium.mjs";

      let protocol = location.protocol === "https:" ? "wss://" : "ws://";
      const host = location.host;
      setWisp(`${protocol}${host}/wisp/`);
      setTransport("epoxy");

      const input = document.getElementById("rogoisdabest");
      input.addEventListener("keyup", async (e) => {
        if (e.key === "Enter" || e.keyCode === 13) {
          const tabNumber = activeTabId.replace("tab", "");
          const iframe = document.getElementById("frame" + tabNumber);
          const url = await getProxied(makeURL(input.value));
          iframe.src = url;
          input.value = getOriginalUrl(iframe.src);
          console.log("Loading URL in", iframe.id, ":", url);
          let tabName = document.querySelector(".tabName");
          tabName.textContent = getWebsiteName(input.value);
        }
      });
    </script>
  </body>
</html>
